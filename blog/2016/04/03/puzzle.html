<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

<head>
 <meta http-equiv="content-type" content="text/html; charset=utf-8" />
 
   <title>Solving the Puzzle</title>
 
 <meta name="author" content="Alexandre Rademaker" />
 <link href="http://feeds.feedburner.com/arademaker" rel="alternate"
       title="Alexandre Rademaker" type="application/atom+xml" />
 
 <!-- syntax highlighting CSS -->
 <link rel="stylesheet" href="/css/syntax.css" type="text/css" />
 <link rel="stylesheet" href="/css/table.css" type="text/css" />

 <!-- <link href="/css/highlight.css" rel="stylesheet" type="text/css"> -->
 <link href="/css/gists.css" rel="stylesheet" type="text/css"/>

 <!-- CSS -->
 <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />

 <!-- Typekit 
 <script type="text/javascript" src="http://use.typekit.com/jpd0pfm.js"></script>
 <script type="text/javascript">try{Typekit.load();}catch(e){}</script>
 -->

 <link href='http://fonts.googleapis.com/css?family=Inconsolata' rel='stylesheet' type='text/css'>



<!-- Google Analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-97240-6']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>
</head>

<body>
  <div id="outer">
    <div id="top"></div>

    <div id="left">
      <img src="/images/eu-sf.jpg"/>
    </div>  

    <div class="site">
      <div class="title">
	<a href="/">Alexandre Rademaker</a>
	<a class="extra" href="/about.html">about me</a>
	<a class="extra" href="/publications.html">publications</a>
	<a class="extra" href="/advising.html">advising</a>
        <a class="extra" href="/research.html">research</a>
	<a class="extra" href="/teaching.html">teaching</a>
      </div>
      
      <div id="post">
  <h1> Solving the Puzzle </h1>

  <p>Solving the <a href="http://fivethirtyeight.com/features/can-you-solve-the-impossible-puzzle/">Can You Solve The Impossible Puzzle?</a> with Common Lisp and
  <a href="http://orgmode.org">Org Mode</a>.</p>
<p>Our search space contains 45 possible candidates of pairs of
  numbers. The tables below will have one candidate of a pair on each
  row. In the first column, we have the multiple, in the second column
  the sum and the last two columns the candidate pair. The <code>prune</code>
  function will help us to reduce the search space on each interaction,
  filtering the elements without repetition.</p>
<pre class="src" lang="lisp">
(ql:quickload :group-by)

(defun prune (data func)
  (let* ((pre (group-by:group-by-repeated data :keys (list func)))
         (input (remove-if (lambda (p) (&lt;= (length (cdr p)) 1)) pre)))
    (reduce (lambda (acc a) (append acc (cdr a))) input
            :initial-value &#39;((m s x y)))))

(cons &#39;(m s x y)
      (loop for x from 1 to 9
            append (loop for y from 9 downto x
                         collect (list (* x y) (+ x y) x y))))
</pre>
<p>#+RESULTS[ca79f9a22ba8cd356c32197a5ac0ad93f8159c81]: start</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>7</td><td>8</td><td>1</td><td>7</td></tr>
  <tr><td>6</td><td>7</td><td>1</td><td>6</td></tr>
  <tr><td>5</td><td>6</td><td>1</td><td>5</td></tr>
  <tr><td>4</td><td>5</td><td>1</td><td>4</td></tr>
  <tr><td>3</td><td>4</td><td>1</td><td>3</td></tr>
  <tr><td>2</td><td>3</td><td>1</td><td>2</td></tr>
  <tr><td>1</td><td>2</td><td>1</td><td>1</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>14</td><td>9</td><td>2</td><td>7</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>10</td><td>7</td><td>2</td><td>5</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>6</td><td>5</td><td>2</td><td>3</td></tr>
  <tr><td>4</td><td>4</td><td>2</td><td>2</td></tr>
  <tr><td>27</td><td>12</td><td>3</td><td>9</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>21</td><td>10</td><td>3</td><td>7</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>15</td><td>8</td><td>3</td><td>5</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>36</td><td>13</td><td>4</td><td>9</td></tr>
  <tr><td>32</td><td>12</td><td>4</td><td>8</td></tr>
  <tr><td>28</td><td>11</td><td>4</td><td>7</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>20</td><td>9</td><td>4</td><td>5</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>45</td><td>14</td><td>5</td><td>9</td></tr>
  <tr><td>40</td><td>13</td><td>5</td><td>8</td></tr>
  <tr><td>35</td><td>12</td><td>5</td><td>7</td></tr>
  <tr><td>30</td><td>11</td><td>5</td><td>6</td></tr>
  <tr><td>25</td><td>10</td><td>5</td><td>5</td></tr>
  <tr><td>54</td><td>15</td><td>6</td><td>9</td></tr>
  <tr><td>48</td><td>14</td><td>6</td><td>8</td></tr>
  <tr><td>42</td><td>13</td><td>6</td><td>7</td></tr>
  <tr><td>36</td><td>12</td><td>6</td><td>6</td></tr>
  <tr><td>63</td><td>16</td><td>7</td><td>9</td></tr>
  <tr><td>56</td><td>15</td><td>7</td><td>8</td></tr>
  <tr><td>49</td><td>14</td><td>7</td><td>7</td></tr>
  <tr><td>72</td><td>17</td><td>8</td><td>9</td></tr>
  <tr><td>64</td><td>16</td><td>8</td><td>8</td></tr>
  <tr><td>81</td><td>18</td><td>9</td><td>9</td></tr>
</table>
<p>In the first time that Barack asked Pete, if Pete knew the answer his
  multiple would be unique defined in the candidate list, that was not
  the case, so we must remove the multiples without repetitions.</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;first)
</pre>
<p>#+RESULTS[6db81e23c88ea3483e1865437f8de0f9cca170cd]: step-1</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>36</td><td>12</td><td>6</td><td>6</td></tr>
  <tr><td>36</td><td>13</td><td>4</td><td>9</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>4</td><td>4</td><td>2</td><td>2</td></tr>
  <tr><td>4</td><td>5</td><td>1</td><td>4</td></tr>
  <tr><td>6</td><td>5</td><td>2</td><td>3</td></tr>
  <tr><td>6</td><td>7</td><td>1</td><td>6</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
</table>
<p>When Barack asked Susan for the first time, she already knew that Pete
  didn&#8217;t know the answer either. So the candidate list in her mind is
  the list above. But she didn&#8217;t know the answer of Barack&#8217;s question
  either, so her sum are not unique in this list too.</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;second)
</pre>
<p>#+RESULTS[2ac1f2a3d955fbf7a89f6db99a91c8f902775483]: step-2</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>6</td><td>5</td><td>2</td><td>3</td></tr>
  <tr><td>4</td><td>5</td><td>1</td><td>4</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>6</td><td>7</td><td>1</td><td>6</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
</table>
<p>In the second time that Barack asked Pete, he still didn&#8217;t know. So we
  have to exclude all unique multiples again.</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;first)
</pre>
<p>#+RESULTS[d5b928145f97d2bea7471b63383a9e34d6178b5a]: step-3</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>6</td><td>7</td><td>1</td><td>6</td></tr>
  <tr><td>6</td><td>5</td><td>2</td><td>3</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
</table>
<p>The same again for the second time Barack asked Susan:</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;second)
</pre>
<p>#+RESULTS[17b25e5fc689d147eda2bd35c388cde44f310568]: step-4</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>6</td><td>7</td><td>1</td><td>6</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
</table>
<p>Pete in the third time still didn&#8217;t know.</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;first)
</pre>
<p>#+RESULTS[44d455fea1e59e9db1788bb012f6cdd4abcc32f1]: step-5</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>12</td><td>7</td><td>3</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
</table>
<p>Susan in the third still didn&#8217;t know.</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;second)
</pre>
<p>#+RESULTS[7a0a13546e37c1bd0d1fff1059eb069b381cbd30]: step-6</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>12</td><td>8</td><td>2</td><td>6</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
</table>
<p>Pete once more didn&#8217;t know:</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;first)
</pre>
<p>#+RESULTS[079394364b443353af7d9353a8c0a38835b09ee2]: step-7</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>16</td><td>8</td><td>4</td><td>4</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
</table>
<p>Susan in the fourth time didn&#8217;t know either:</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;second)
</pre>
<p>#+RESULTS[e8f43474732654a4d80a659c50fe51b7ddba6a28]: step-8</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>16</td><td>10</td><td>2</td><td>8</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
</table>
<p>At this moment, in the fifth time, Pete knew the answer. That is, his
  number should be 16, since this is the only multiple that unique
  defines the candidates: 2 and 8.</p>
<p>If Pete didn&#8217;t knew at this time, Barack would have asked once more to
  Susan and we would have to exclude the pair <code>(2,8)</code> from the list of
  candidates:</p>
<pre class="src" lang="lisp">
(prune (cdr data) #&#39;first)
</pre>
<p>#+RESULTS[b04f949aa4cfaea9ae9f63533fc50b207336f698]: step-9</p>
<table>
  <tr><td>m</td><td>s</td><td>x</td><td>y</td></tr>
  <tr><td>24</td><td>10</td><td>4</td><td>6</td></tr>
  <tr><td>24</td><td>11</td><td>3</td><td>8</td></tr>
  <tr><td>18</td><td>11</td><td>2</td><td>9</td></tr>
  <tr><td>18</td><td>9</td><td>3</td><td>6</td></tr>
  <tr><td>8</td><td>9</td><td>1</td><td>8</td></tr>
  <tr><td>8</td><td>6</td><td>2</td><td>4</td></tr>
  <tr><td>9</td><td>10</td><td>1</td><td>9</td></tr>
  <tr><td>9</td><td>6</td><td>3</td><td>3</td></tr>
</table>
<p>In this candidate list, Susan would not be able to identify the
  numbers since no sum is unique.</p>
<h1>Links</h1>
<ul>
  <li><a href="https://www.jstatsoft.org/article/view/v046i03">A Multi-Language Computing Environment for Literate Programming and
    Reproducible Research</a></li>
  <li><a href="http://orgmode.org">http://orgmode.org</a></li>
  <li><a href="http://quicklisp.org">http://quicklisp.org</a></li>
  <li><a href="https://common-lisp.net">Common Lisp</a></li>
</ul>


 <hr/>

 <div id="disqus_thread"></div>
 <script type="text/javascript">
   var disqus_shortname = 'arademaker'; 
   (function() {
     var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
     dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
     (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
 </script>
 <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>




      <div class="footer">
	<div class="contact">
	  <p>
            Professor at <a href="http://emap.fgv.br/">EMAp/FGV</a>, Researcher at <a href="http://research.ibm.com">IBM</a><br/>
            arademaker AT gmail DOT com
	  </p>
	  
	  <p><a id="academia-button" href="https://ibm.academia.edu/AlexandreRademaker">Follow me on Academia.edu</a><script src="//a.academia-assets.com/javascripts/social.js"></script></p>

	  <p>
	    <a href="http://github.com/arademaker/">github.com/arademaker</a> - 
            <a href="http://twitter.com/arademaker/">twitter.com/arademaker</a> - 
            <a href="http://facebook.com/alexandre.rademaker">Facebook</a> -
	    <a href="https://scholar.google.com.br/citations?user=SWz6BjIAAAAJ&hl=en">Google Scholar</a>
	  </p>
	  <p>The postings and pages on this site are my own and don't
	    necessarily represent IBM's or FGV's positions, strategies
	    or opinions.</p>
	</div>	
	<div class="rss">
	  <p><a href="http://feeds.feedburner.com/arademaker"><img src="/images/rss.png" alt="Subscribe to RSS Feed" /></a></p>
	</div>
      </div>
    </div>

    <div id="right">
    </div>
  </div>
</body>
</html>
